<head>
	<title>timesheet</title>
	<link id="favicon" rel="icon" sizes="16x16 32x32" href="/favicon.png">
</head>

<body>

	{{> App}}

</body>

<template name="App">
	{{> NavBar}}

	{{> TimeSheet user}}
</template>

<template name="NavBar">
	<nav class="navbar navbar-default" role="navigation">
		<div class="container-fluid">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand btn-show-timesheet" href="#">Time Sheet</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				
				<ul class="nav navbar-nav navbar-right">
					<li>{{> clockoutButton class="navbar-btn"}}</li>
					{{> loginButtons}}
				</ul>

			</div><!-- /.navbar-collapse -->
		</div><!-- /.container-fluid -->
	</nav>
</template>


<template name="clockoutButton">
	{{#if clockedIn}}
		<button class="btn btn-danger btn-clockOut {{class}}">
			<i class="fa fa-circle-o-notch fa-spin"></i>
		</button>
	{{else}}
		<button class="btn btn-success btn-clockIn {{class}}">
			<i class="fa fa-clock-o"></i>
		</button>
	{{/if}}
</template>

<template name="TimeSheet">
	{{autosave}}
	<div class="table-responsive">
		<table class="table">
			<thead>
				<tr>
					<th></th>
					{{#each timeSpans}}
						<th style="text-align: right;" class="col-sm-1">{{name}}</th>
					{{/each}}
					<th></th>
				</tr>
			</thead>
			<tbody>
				{{#with profile}}
					{{> CategoryRows}}
					{{#unless selectedCategory}}
						<tr>
							<td colspan="7" style="text-align: center;">
								<button class="btn btn-link btn-add-category">
									<i class="fa fa-plus"></i>
								</button>
							</td>
						</tr>
					{{/unless}}
				{{/with}}
			</tbody>
			<tfoot>
				<tr>
					<th>
						Total
					</th>
					{{#each timeSpans}}
						<td style="text-align: right;">{{time}}</td>
					{{/each}}
				</tr>
			</tfoot>
		</table>
	</div>
</template>

<template name="CategoryRows">
	{{#each categories}}
		{{> CategoryRow}}
	{{/each}}
</template>

<template name="CategoryRow">
	<tr class="vert-align categoryRow {{#if current}}active{{/if}}">
		<th style="padding-left: {{padding}};">
			{{name}}
			{{#if description}}
				<br>
				<small>{{description}}</small>
			{{/if}}
		</th>
		{{#each timeSpans}}
			<td style="text-align: right;">
				{{time}}
			</td>
		{{/each}}
		<td style="text-align: right;">
			{{#if current}}
				<button class="btn btn-danger btn-remove-category">
					<i class="fa fa-times"></i>
				</button>
				<button class="btn {{#if editing}}btn-primary{{else}}btn-default{{/if}} btn-edit-category">
					<i class="fa fa-pencil"></i>
				</button>
			{{/if}}
			{{> clockoutButton path=path}}
		</td>

	</tr>
	{{#if editing}}
		<tr>
			<td colspan="20">
				<div class="well" style="max-height: 400px; overflow: auto;">
					<form class="">
						<div class="form-group">
							<label>Name</label>
							<input
								type="text"
								name="name"
								value="{{name}}"
								class="form-control"
								>
						</div>
						<div class="form-group">
							<label>Description</label>
							<input
								type="text"
								name="description"
								value="{{description}}"
								class="form-control"
								>
						</div>
					</form>
					<table class="table">
						<thead>
							<tr>
								<th>Start</th>
								<th>End</th>
								<th>Duration</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							{{#each entries}}
								{{> TimeEntry}}
							{{/each}}
						</tbody>
					</table>
				</div>
			</td>
		</tr>
	{{/if}}
	{{#if selected}}
		{{> CategoryRows}}
	{{/if}}
	{{#if current}}
		<tr>
			<td colspan="7" style="padding-left: {{padding}};">
				<button class="btn btn-link btn-add-category">
					{{name}} / <i class="fa fa-plus"></i>
				</button>
			</td>
		</tr>
	{{/if}}
</template>

<template name="TimeEntry">
	<tr>
		<td>{{start}}</td>
		<td>{{end}}</td>
		<td>{{time}}</td>
		<td></td>
	</tr>
</template>
